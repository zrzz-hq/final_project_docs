<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>test.test - Final Project Docs</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "test.test";
        var mkdocs_page_input_path = "test/test.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Final Project Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Getting Start</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting_start/your_own_computer/">On your own computer</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../getting_start/HiPerGator/">On HiPerGator</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" >test</a>
    <ul class="current">
                <li class="toctree-l2 current"><a class="reference internal current" href="#">test.test</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#arguments">Arguments</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#returns">Returns</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#how-it-works">How It Works</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#example-usage">Example Usage</a>
    </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../run/">test.run</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >train</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../train/train/">train.train</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Final Project Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">API Reference</li>
          <li class="breadcrumb-item">test</li>
      <li class="breadcrumb-item active">test.test</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="testtest"><code>test.test</code></h1>
<div style="font-family: monospace; font-size: 14px; color: #333; background-color: #f8f9fa; border: 1px solid #ddd; border-left: 4px solid #007bff; padding: 10px; border-radius: 4px;">
<span style="color: #0056b3; font-weight: bold;">test.test</span>(<br>
&nbsp;&nbsp;image_dir, <br>
&nbsp;&nbsp;label_dir, <br>
&nbsp;&nbsp;result_dir = <span style="font-style: italic;">None</span>, <br>
&nbsp;&nbsp;weights = <span style="font-style: italic;">'Pretrained'</span>, <br>
&nbsp;&nbsp;backbone = <span style="font-style: italic;">'resnet34_fpn'</span>, <br>
&nbsp;&nbsp;device = <span style="font-style: italic;">torch.device("cuda" if torch.cuda.is_available() else "cpu")</span>, <br>
&nbsp;&nbsp;batch_size= <span style="font-style: italic;">32</span> , <br>
&nbsp;&nbsp;conf_threshold = <span style="font-style: italic;">0.8</span> <br>
) → <span style="color: #0056b3; font-weight: bold;">tuple[dict, float]</span>
</div>

<p>The function evaluates a pre-trained Faster R-CNN model on a given test dataset and calculates performance metrics, including Mean Average Precision (mAP) and Intersection over Union (IoU). It also optionally saves visualized results with bounding boxes drawn on the test images.</p>
<h2 id="arguments">Arguments</h2>
<ul>
<li>
<p><strong>image_dir</strong> (<code>str</code>):<br />
  Path to the directory containing test images.</p>
</li>
<li>
<p><strong>label_dir</strong> (<code>str</code>):<br />
  Path to the directory containing test labels in YOLO format.</p>
</li>
<li>
<p><strong>result_dir</strong> (<code>str</code>, optional):<br />
  Directory to save test results with bounding boxes. If <code>None</code>, results are not saved.</p>
</li>
<li>
<p><strong>weights</strong> (<code>str</code>):<br />
  Specifies the model weights to use:  </p>
<ul>
<li><code>Pretrained</code>: Loads pre-trained weights from a source.  </li>
<li><code>Default</code>: Initializes the model with default weights provided by the backbone in PyTorch.  </li>
<li><code>None</code>: Starts with randomly initialized weights.  </li>
<li>Custom path: Specify the path to a <code>.pt</code> file containing saved weights.</li>
</ul>
</li>
<li>
<p><strong>backbone</strong> (<code>str</code>, optional if <strong>weights</strong> is set a custom path):<br />
  Backbone architecture. Options:</p>
<ul>
<li><code>resnet34_fpn</code></li>
<li><code>resnet50_fpn</code></li>
<li><code>mobilenetv3_fpn</code></li>
</ul>
</li>
<li>
<p><strong>device</strong> (<code>torch.device</code>):<br />
  Device to run evaluation (CPU or GPU).</p>
</li>
<li>
<p><strong>batch_size</strong> (<code>int</code>):<br />
  Number of samples processed per batch.</p>
</li>
<li>
<p><strong>conf_threshold</strong> (<code>float</code>):<br />
  Confidence threshold for filtering predictions.</p>
</li>
</ul>
<h2 id="returns">Returns</h2>
<ul>
<li>
<p><strong>mAP</strong> (<code>dict</code>):<br />
  Mean Average Precision for the test dataset.</p>
</li>
<li>
<p><strong>IoU</strong> (<code>float</code>):<br />
  Intersection over Union metric for the dataset.</p>
</li>
</ul>
<h2 id="how-it-works">How It Works</h2>
<ol>
<li>Loads the test images and labels using a custom dataset class (<code>YoloDataset</code>).</li>
<li>Initializes a Faster R-CNN model with the specified backbone and weights.</li>
<li>Runs the model on the test dataset in batches, filtering predictions based on confidence.</li>
<li>Updates metrics (<code>mAP</code>, <code>IoU</code>) for each batch.</li>
<li>Optionally, saves the test results with bounding boxes drawn on the images to the specified directory.</li>
</ol>
<h2 id="example-usage">Example Usage</h2>
<pre><code class="language-python">from test import test
from pprint import pprint

mAP, IoU = test(
    image_dir='./data/test_set/images',
    label_dir='./data/test_set/labels',
    result_dir='./results',
    weights='Pretrained',
    backbone='resnet34_fpn',
    batch_size=16,
    conf_threshold=0.8
)

pprint(&quot;Mean Average Precision:&quot;, mAP)
pprint(&quot;Intersection over Union:&quot;, IoU)
</code></pre>
<p>Python Output:</p>
<pre><code class="language-plaintext">Testing: 100%|██████████| 27/27 [00:10&lt;00:00,  2.62it/s]
{'map': 0.5220838189125061,
 'map_50': 0.9335460662841797,
 'map_75': 0.5252417922019958,
 'map_large': 0.5681636929512024,
 'map_medium': 0.4912945032119751,
 'map_small': 0.4415474832057953}
0.6990163922309875
</code></pre>
<p>Images with predicted bounding boxes are saved in <code>./results</code></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../getting_start/HiPerGator/" class="btn btn-neutral float-left" title="On HiPerGator"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../run/" class="btn btn-neutral float-right" title="test.run">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../../getting_start/HiPerGator/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../run/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
